<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Python仮想環境構築ガイド</title>
    <link rel="stylesheet" href="css/style.css">
</head>
<body>
    <a href="index.html" class="back-link">← トップに戻る</a>
    
    <header>
        <h1>🐍 Python仮想環境構築ガイド</h1>
        <p class="subtitle">プロジェクトごとに独立した開発環境を作る</p>
    </header>

    <section class="replace-form">
        <h3>🔄 カスタマイズ設定</h3>
        <label for="projname">プロジェクト名:</label>
        <input type="text" id="projname" class="replace-input" data-placeholder="PROJECT" placeholder="my-project">
        
        <label for="venvname" style="margin-top: 10px;">仮想環境名:</label>
        <input type="text" id="venvname" class="replace-input" data-placeholder="VENV" placeholder="venv">
    </section>

    <section>
        <h2>🤔 なぜ仮想環境が必要なのか？</h2>
        
        <h3>仮想環境とは</h3>
        <p>Python仮想環境は、プロジェクトごとに独立したPython実行環境を作る仕組みです。各プロジェクトで異なるバージョンのパッケージを使い分けることができます。</p>

        <h3>仮想環境を使う3つの理由</h3>
        
        <table>
            <thead>
                <tr>
                    <th>問題</th>
                    <th>仮想環境なし</th>
                    <th>仮想環境あり</th>
                </tr>
            </thead>
            <tbody>
                <tr>
                    <td><strong>パッケージの競合</strong></td>
                    <td>❌ プロジェクトAがDjango 3.0、プロジェクトBがDjango 4.0を必要とする場合、両立できない</td>
                    <td>✅ 各プロジェクトで異なるバージョンを使用可能</td>
                </tr>
                <tr>
                    <td><strong>システムの汚染</strong></td>
                    <td>❌ グローバルにインストールしたパッケージがシステム全体に影響</td>
                    <td>✅ プロジェクト内だけに影響を限定</td>
                </tr>
                <tr>
                    <td><strong>環境の再現性</strong></td>
                    <td>❌ 他の人の環境で動かない「私の環境では動くのに...」問題</td>
                    <td>✅ requirements.txtで環境を完全再現可能</td>
                </tr>
            </tbody>
        </table>

        <h3>具体例：仮想環境がないと起こる問題</h3>
        <div class="code-block">
            <div class="code-header">
                <span class="code-title">トラブル例</span>
                <button class="copy-btn" onclick="copyCode(this)">Copy</button>
            </div>
            <pre><code># プロジェクトAで作業
pip install requests==2.28.0

# プロジェクトBで作業（新しいバージョンが必要）
pip install requests==2.31.0

# プロジェクトAに戻ると...
# → エラー！バージョンが変わってしまった

# 解決策：仮想環境を使う！</code></pre>
        </div>
    </section>

    <section>
        <h2>📋 前提条件</h2>
        <ul>
            <li>Pythonがインストールされている（Python 3.3以降）</li>
            <li>ターミナル（コマンドライン）が使える</li>
        </ul>

        <div class="code-block">
            <div class="code-header">
                <span class="code-title">Pythonバージョン確認</span>
                <button class="copy-btn" onclick="copyCode(this)">Copy</button>
            </div>
            <pre><code># Pythonがインストールされているか確認
python3 --version

# または
python --version

# 出力例: Python 3.11.5</code></pre>
        </div>
    </section>

    <section>
        <h2>🚀 仮想環境の作成（基本編）</h2>
        
        <h3>ステップ1: プロジェクトディレクトリを作成</h3>
        <div class="code-block">
            <div class="code-header">
                <span class="code-title">ディレクトリ作成</span>
                <button class="copy-btn" onclick="copyCode(this)">Copy</button>
            </div>
            <pre><code># プロジェクトディレクトリを作成
mkdir {PROJECT}
cd {PROJECT}

# 現在地を確認
pwd</code></pre>
        </div>

        <h3>ステップ2: 仮想環境を作成</h3>
        <div class="code-block">
            <div class="code-header">
                <span class="code-title">venv作成</span>
                <button class="copy-btn" onclick="copyCode(this)">Copy</button>
            </div>
            <pre><code># 仮想環境を作成（venvという名前で）
python3 -m venv {VENV}

# 作成されたか確認
ls -la

# 以下のディレクトリが作成される:
# {VENV}/
# ├── bin/          # 実行ファイル
# ├── include/      # ヘッダーファイル
# ├── lib/          # パッケージ
# └── pyvenv.cfg    # 設定ファイル</code></pre>
        </div>

        <h3>ステップ3: 仮想環境を有効化</h3>
        <div class="code-block">
            <div class="code-header">
                <span class="code-title">有効化（macOS/Linux）</span>
                <button class="copy-btn" onclick="copyCode(this)">Copy</button>
            </div>
            <pre><code># macOS / Linux / WSL
source {VENV}/bin/activate

# 有効化されると、プロンプトの先頭に (venv) が表示される
# ({VENV}) user@computer:~/project$</code></pre>
        </div>

        <div class="code-block">
            <div class="code-header">
                <span class="code-title">有効化（Windows）</span>
                <button class="copy-btn" onclick="copyCode(this)">Copy</button>
            </div>
            <pre><code># Windows (Command Prompt)
{VENV}\Scripts\activate.bat

# Windows (PowerShell)
{VENV}\Scripts\Activate.ps1

# PowerShellで実行ポリシーエラーが出る場合
Set-ExecutionPolicy -ExecutionPolicy RemoteSigned -Scope CurrentUser</code></pre>
        </div>

        <h3>ステップ4: 仮想環境が有効か確認</h3>
        <div class="code-block">
            <div class="code-header">
                <span class="code-title">確認方法</span>
                <button class="copy-btn" onclick="copyCode(this)">Copy</button>
            </div>
            <pre><code># どのPythonを使っているか確認
which python3
# 出力例: /Users/username/{PROJECT}/{VENV}/bin/python3

# または
python3 -c "import sys; print(sys.prefix)"
# 仮想環境のパスが表示されればOK

# インストール済みパッケージを確認
pip list
# 最小限のパッケージのみ表示される</code></pre>
        </div>
    </section>

    <section>
        <h2>📦 パッケージのインストール</h2>
        
        <h3>仮想環境内でパッケージをインストール</h3>
        <div class="code-block">
            <div class="code-header">
                <span class="code-title">パッケージインストール</span>
                <button class="copy-btn" onclick="copyCode(this)">Copy</button>
            </div>
            <pre><code># 仮想環境が有効化されていることを確認
# プロンプトに ({VENV}) が表示されているか

# パッケージをインストール
pip install requests

# 複数のパッケージを一度にインストール
pip install requests numpy pandas

# 特定バージョンをインストール
pip install django==4.2.0

# インストール済みパッケージを確認
pip list</code></pre>
        </div>

        <h3>requirements.txt の作成</h3>
        <div class="code-block">
            <div class="code-header">
                <span class="code-title">依存関係の保存</span>
                <button class="copy-btn" onclick="copyCode(this)">Copy</button>
            </div>
            <pre><code># 現在の環境のパッケージリストを保存
pip freeze > requirements.txt

# requirements.txtの内容を確認
cat requirements.txt

# 出力例:
# requests==2.31.0
# numpy==1.24.3
# pandas==2.0.3</code></pre>
        </div>

        <h3>requirements.txt からインストール</h3>
        <div class="code-block">
            <div class="code-header">
                <span class="code-title">環境の再現</span>
                <button class="copy-btn" onclick="copyCode(this)">Copy</button>
            </div>
            <pre><code># requirements.txtから一括インストール
pip install -r requirements.txt

# これで他の人や他の環境でも同じパッケージ構成を再現できる</code></pre>
        </div>
    </section>

    <section>
        <h2>🔄 仮想環境の操作</h2>
        
        <table>
            <thead>
                <tr>
                    <th>操作</th>
                    <th>コマンド（macOS/Linux）</th>
                    <th>コマンド（Windows）</th>
                </tr>
            </thead>
            <tbody>
                <tr>
                    <td>有効化</td>
                    <td><code>source {VENV}/bin/activate</code></td>
                    <td><code>{VENV}\Scripts\activate</code></td>
                </tr>
                <tr>
                    <td>無効化</td>
                    <td><code>deactivate</code></td>
                    <td><code>deactivate</code></td>
                </tr>
                <tr>
                    <td>削除</td>
                    <td><code>rm -rf {VENV}</code></td>
                    <td><code>rmdir /s {VENV}</code></td>
                </tr>
                <tr>
                    <td>再作成</td>
                    <td><code>python3 -m venv {VENV}</code></td>
                    <td><code>python -m venv {VENV}</code></td>
                </tr>
            </tbody>
        </table>
    </section>

    <section>
        <h2>📁 .gitignore の設定</h2>
        
        <p>仮想環境のディレクトリはGitで管理しません。代わりにrequirements.txtを共有します。</p>

        <div class="code-block">
            <div class="code-header">
                <span class="code-title">.gitignoreファイル作成</span>
                <button class="copy-btn" onclick="copyCode(this)">Copy</button>
            </div>
            <pre><code>cat > .gitignore << 'IGNORE'
# 仮想環境
{VENV}/
venv/
env/
ENV/
.venv/

# Python関連
__pycache__/
*.py[cod]
*$py.class
*.so
.Python

# IDE
.vscode/
.idea/
*.swp

# OS
.DS_Store
Thumbs.db
IGNORE</code></pre>
        </div>
    </section>

    <section>
        <h2>🚀 GitHubにアップロードする方法</h2>
        
        <h3>ステップ1: Gitリポジトリの初期化</h3>
        <div class="code-block">
            <div class="code-header">
                <span class="code-title">Git初期化</span>
                <button class="copy-btn" onclick="copyCode(this)">Copy</button>
            </div>
            <pre><code># プロジェクトディレクトリで実行
cd {PROJECT}

# Gitリポジトリを初期化
git init

# .gitignoreを作成（上記参照）

# requirements.txtを作成
pip freeze > requirements.txt

# 状態確認
git status</code></pre>
        </div>

        <h3>ステップ2: 初回コミット</h3>
        <div class="code-block">
            <div class="code-header">
                <span class="code-title">コミット</span>
                <button class="copy-btn" onclick="copyCode(this)">Copy</button>
            </div>
            <pre><code># すべてのファイルを追加（venvは.gitignoreで除外される）
git add .

# コミット
git commit -m "Initial commit: プロジェクト初期設定"

# 確認
git log --oneline</code></pre>
        </div>

        <h3>ステップ3: GitHubリポジトリの作成</h3>
        <div class="code-block">
            <div class="code-header">
                <span class="code-title">GitHubリポジトリ作成</span>
                <button class="copy-btn" onclick="copyCode(this)">Copy</button>
            </div>
            <pre><code># 方法A: ブラウザで作成
# 1. https://github.com/new にアクセス
# 2. Repository name: {PROJECT}
# 3. Public を選択
# 4. README, .gitignore, license は追加しない
# 5. Create repository をクリック

# 方法B: GitHub CLIで作成
gh auth login
gh repo create {PROJECT} --public --source=. --remote=origin</code></pre>
        </div>

        <h3>ステップ4: リモートリポジトリと連携</h3>
        <div class="code-block">
            <div class="code-header">
                <span class="code-title">リモート追加とプッシュ</span>
                <button class="copy-btn" onclick="copyCode(this)">Copy</button>
            </div>
            <pre><code># リモートリポジトリを追加
git remote add origin https://github.com/USERNAME/{PROJECT}.git

# ブランチ名をmainに
git branch -M main

# プッシュ
git push -u origin main</code></pre>
        </div>

        <h3>ステップ5: README.md の作成</h3>
        <div class="code-block">
            <div class="code-header">
                <span class="code-title">README作成</span>
                <button class="copy-btn" onclick="copyCode(this)">Copy</button>
            </div>
            <pre><code>cat > README.md << 'README'
# {PROJECT}

プロジェクトの説明

## セットアップ方法

### 1. リポジトリをクローン

```bash
git clone https://github.com/USERNAME/{PROJECT}.git
cd {PROJECT}
2. 仮想環境を作成
Copypython3 -m venv {VENV}
source {VENV}/bin/activate  # macOS/Linux
# または
{VENV}\Scripts\activate  # Windows
3. 依存パッケージをインストール
Copypip install -r requirements.txt
4. 実行
Copypython main.py
使い方
プロジェクトの使い方を記載

ライセンス
MIT License README

コミット＆プッシュ
git add README.md git commit -m "Add: README作成" git push origin main

<section>
    <h2>🔄 他の人が環境を再現する手順</h2>
    
    <div class="code-block">
        <div class="code-header">
            <span class="code-title">完全な再現手順</span>
            <button class="copy-btn" onclick="copyCode(this)">Copy</button>
        </div>
        <pre><code># 1. リポジトリをクローン
git clone https://github.com/USERNAME/{PROJECT}.git cd {PROJECT}

2. 仮想環境を作成
python3 -m venv {VENV}

3. 仮想環境を有効化
source {VENV}/bin/activate # macOS/Linux

または
{VENV}\Scripts\activate # Windows

4. 依存パッケージを一括インストール
pip install -r requirements.txt

5. 動作確認
python --version pip list

これで元の環境と同じ状態が再現される！
    </div>
</section>

<section>
    <h2>💡 便利なテクニック</h2>
    
    <h3>テクニック1: 仮想環境名を統一する</h3>
    <div class="code-block">
        <div class="code-header">
            <span class="code-title">推奨の命名</span>
            <button class="copy-btn" onclick="copyCode(this)">Copy</button>
        </div>
        <pre><code># 一般的な仮想環境名
venv # 最も一般的 .venv # 隠しディレクトリとして env # シンプル virtualenv # 明示的

プロジェクトごとに統一すると管理しやすい
    </div>

    <h3>テクニック2: エイリアスを設定</h3>
    <div class="code-block">
        <div class="code-header">
            <span class="code-title">ショートカット設定</span>
            <button class="copy-btn" onclick="copyCode(this)">Copy</button>
        </div>
        <pre><code># ~/.zshrc または ~/.bashrc に追加
alias venv-create='python3 -m venv venv' alias venv-activate='source venv/bin/activate' alias venv-deactivate='deactivate' alias venv-freeze='pip freeze > requirements.txt' alias venv-install='pip install -r requirements.txt'

使用例
cd my-project venv-create venv-activate

    <h3>テクニック3: 複数のPythonバージョンを使い分け</h3>
    <div class="code-block">
        <div class="code-header">
            <span class="code-title">バージョン指定</span>
            <button class="copy-btn" onclick="copyCode(this)">Copy</button>
        </div>
        <pre><code># 特定のPythonバージョンで仮想環境を作成
python3.11 -m venv venv-py311 python3.10 -m venv venv-py310

pyenvを使う場合
pyenv install 3.11.5 pyenv local 3.11.5 python -m venv venv

    <h3>テクニック4: 開発用と本番用で分ける</h3>
    <div class="code-block">
        <div class="code-header">
            <span class="code-title">requirements分割</span>
            <button class="copy-btn" onclick="copyCode(this)">Copy</button>
        </div>
        <pre><code># requirements/base.txt（共通）
requests>=2.31.0 django>=4.2.0

requirements/dev.txt（開発用）
-r base.txt pytest>=7.4.0 black>=23.7.0 flake8>=6.1.0

requirements/prod.txt（本番用）
-r base.txt gunicorn>=21.2.0

インストール
pip install -r requirements/dev.txt

<section>
    <h2>❌ トラブルシューティング</h2>
    
    <h3>問題1: 仮想環境が有効化できない</h3>
    <div class="code-block">
        <div class="code-header">
            <span class="code-title">解決方法</span>
            <button class="copy-btn" onclick="copyCode(this)">Copy</button>
        </div>
        <pre><code># 原因1: パスが間違っている
確認
ls -la venv/bin/activate

原因2: 実行権限がない
chmod +x venv/bin/activate

原因3: Windowsで実行ポリシーエラー
PowerShellで実行
Set-ExecutionPolicy -ExecutionPolicy RemoteSigned -Scope CurrentUser

    <h3>問題2: pipが古い</h3>
    <div class="code-block">
        <div class="code-header">
            <span class="code-title">pipのアップグレード</span>
            <button class="copy-btn" onclick="copyCode(this)">Copy</button>
        </div>
        <pre><code># 仮想環境内でpipをアップグレード
pip install --upgrade pip

確認
pip --version

    <h3>問題3: requirements.txtからインストールできない</h3>
    <div class="code-block">
        <div class="code-header">
            <span class="code-title">デバッグ方法</span>
            <button class="copy-btn" onclick="copyCode(this)">Copy</button>
        </div>
        <pre><code># 詳細ログを表示
pip install -r requirements.txt -v

一つずつインストールして問題を特定
pip install requests pip install numpy

...
キャッシュをクリア
pip cache purge pip install -r requirements.txt

    <h3>問題4: 仮想環境を削除したい</h3>
    <div class="code-block">
        <div class="code-header">
            <span class="code-title">完全削除</span>
            <button class="copy-btn" onclick="copyCode(this)">Copy</button>
        </div>
        <pre><code># まず無効化
deactivate

仮想環境ディレクトリを削除
rm -rf venv

再作成
python3 -m venv venv source venv/bin/activate pip install -r requirements.txt

<section>
    <h2>🎯 まとめ</h2>
    
    <h3>基本的なワークフロー</h3>
    <div class="code-block">
        <div class="code-header">
            <span class="code-title">新規プロジェクト開始</span>
            <button class="copy-btn" onclick="copyCode(this)">Copy</button>
        </div>
        <pre><code># 1. プロジェクト作成
mkdir {PROJECT} && cd {PROJECT}

2. 仮想環境作成
python3 -m venv venv

3. 有効化
source venv/bin/activate

4. パッケージインストール
pip install requests pandas numpy

5. requirements.txt作成
pip freeze > requirements.txt

6. .gitignore作成
echo "venv/" > .gitignore

7. Git管理開始
git init git add . git commit -m "Initial commit"

8. GitHubにプッシュ
git remote add origin https://github.com/USERNAME/{PROJECT}.git git push -u origin main

    <h3>既存プロジェクトのセットアップ</h3>
    <div class="code-block">
        <div class="code-header">
            <span class="code-title">クローン後の作業</span>
            <button class="copy-btn" onclick="copyCode(this)">Copy</button>
        </div>
        <pre><code># 1. クローン
git clone https://github.com/USERNAME/{PROJECT}.git cd {PROJECT}

2. 仮想環境作成
python3 -m venv venv

3. 有効化
source venv/bin/activate

4. 依存パッケージインストール
pip install -r requirements.txt

5. 動作確認
python main.py

<section>
    <h2>📚 参考資料</h2>
    <ul>
        <li><a href="https://docs.python.org/ja/3/library/venv.html" target="_blank">Python公式ドキュメント: venv</a></li>
        <li><a href="https://packaging.python.org/guides/installing-using-pip-and-virtual-environments/" target="_blank">pip and virtual environments</a></li>
    </ul>
</section>

<script src="js/script.js"></script>
